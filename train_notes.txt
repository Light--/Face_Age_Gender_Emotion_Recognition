python3 demo.py \
--use_webcam=False \
--input_video_path="input/dinner.mp4" \
--output_emotion_images=False \
--output_video=False \
--slow_rate=1.0 \
--face_confidence_threshold=0.2 \
--use_cascade=False

-------------------------------------------------------------------------------------------------------------
* 01.
lr: 0.1(0~25%) -> 0.01(26~50%) -> 0.001(51~75%) -> 0.0001(76~100%)
==>
python3 train.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
30
==>
best val_loss: 3.69925
best train
    [console output for last epoch]
    loss: 2.9443
    output_gender_loss: 0.1300
    output_age_loss: 1.7644
    output_emotion_loss: 0.1561
* 本機訓練時間：大概11小時
* 三種 loss，都是持續下降
* 影片實測(demo_old.py)：性別、情緒，跟使用兩個model時差不多。年齡比用兩個model時還差一些

-------------------------------------------------------------------------------------------------------------
02. compared with 1
batch size 32: 20 for agender, 12 for emotion
==>
python3 train.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
30
==>
best val_loss: 4.72740
best train
    [console output for last epoch]
    loss: 4.0474
    output_gender_loss: 0.4332
    output_age_loss: 2.8845
    output_emotion_loss: 0.7297
    [smooth on tensorboard]
    output_gender_acc: 0.658
    output_age_myMAE: 28.9
    output_emotion_acc: 0.67
* 三種 loss，都是持續下降
* 影片實測(demo.py)：三種估計都保持一樣的值，debug 後看 probability 的值都一樣

-------------------------------------------------------------------------------------------------------------
03.
1) model.fit: use class_weight
2) epoch: 5
==>
python3 train.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
5
==>
best val_loss: 4.80039
best train
    [console output for last epoch]
    loss: 4.4601
    output_gender_loss: 0.3465
    output_age_loss: 2.2145
    output_emotion_loss: 0.9700
    output_gender_acc: 0.5642
    output_age_myMAE: 23.9686
    output_emotion_acc: 0.8445
start_time: 2019-04-22 21:01:38, end_time: 2019-04-22 22:56:50
* 影片實測(demo.py)：三種估計都保持一樣的值，debug 後看 probability 的值都一樣

-------------------------------------------------------------------------------------------------------------
04. compared with 3
epoch: 30
==>
python3  train.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
30
==>
only run 27 epochs, system auto-restart on 28-th epoch
[train_log.csv, epoch 4]
loss: 3.5301699674
output_age_loss: 2.2133648892
output_age_myMAE: 33.0698193195
output_emotion_acc: 0.5700477148
output_emotion_loss: 0.9704015028
output_gender_acc: 0.7259660647
output_gender_loss: 0.3464035732
val_loss: 4.7274011164
val_output_age_loss: 3.8178319799
val_output_age_myMAE: 23.9685645918
val_output_emotion_acc: 0.8508784597
val_output_emotion_loss: 0.336167092
val_output_gender_acc: 0.5638026474
val_output_gender_loss: 0.5734020447
* 影片實測(demo.py)：三種估計都保持一樣的值，debug 後看 probability 的值都一樣

-------------------------------------------------------------------------------------------------------------
05.
1) model.fit: use class_weight
2) --nb_epochs 10
3) --lr 0.05
4) --staircase_decay_at_epochs (5,8,): 6-th and 9-th epoch if 1-th is the first epoch
==>
python3 train.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
10
--staircase_decay_at_epochs
(5,8,)
--lr
0.05
==>
start_time: 2019-04-23 17:41:15, end_time: 2019-04-23 21:26:10
* 本機訓練時間： 10 epoch 大約3小時45分
* 影片實測(demo.py)：三種估計都保持一樣的值，debug 後看 probability 的值都一樣

-------------------------------------------------------------------------------------------------------------
06. train.py
1) no class_weight
2) --nb_epochs 10
3) --lr 0.1
4) --staircase_decay_at_epochs (5,8,)
5) 不要對變數做 del
==>
python3 train.py \
--input_agender data/imdb_db.mat \
--input_emotion data/fer2013/fer2013.csv \
--nb_epochs 10 \
--staircase_decay_at_epochs (5,8,) \
--lr 0.1
==>
start_time: 2019-04-24 03:26:02, end_time: 2019-04-24 05:42:50
* 影片實測(demo.py)：三種估計都保持一樣的值，debug 後看 probability 的值都一樣

-------------------------------------------------------------------------------------------------------------
07. compared with 6.
1) class WideResNet: kernel_initializer=keras.initializers.random_normal(stddev=0.01)
2) --nb_epochs 2
3) StaircaseSchedule
==>
python3 train.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
2
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
==>
* 影片實測(demo.py)： 2-th epoch is better

-------------------------------------------------------------------------------------------------------------
08. compared with 7.
1) --nb_epochs 20
2) NewSchedule
==>
python3 train.py \
--input_agender /media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat \
--input_emotion /media/vincentkao/Data/datasets/fer2013/fer2013.csv \
--nb_epochs 20 \
--staircase_decay_at_epochs "(5,8,)" \
--lr 0.1
==>
start_time: 2019-04-24 16:08:46, end_time: 2019-04-24 20:48:27

-------------------------------------------------------------------------------------------------------------
* 09. compared with 7.
1) --nb_epochs 10
2) StaircaseSchedule
==>
python3 train.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
10
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
loss: 3.0684 (last)
val_loss: 3.7351 (best)
==>
* 影片實測(demo.py)：
    a) 結果與1.差不多
    b) 性別、情緒準度與兩個模型差異不大，但年齡準度變差

-------------------------------------------------------------------------------------------------------------
10. compared with 9.
1) use keras MobileNetV2
==>
python3 train.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
10
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
==>
start_time: 2019-04-25 17:45:00, end_time: 2019-04-25 18:30:15
* 本機訓練時間： 10 epoch 大約45分，而 WideResNet 大約3小時45分
* 影片實測(demo.py)： 準度很差
* 總參數量大約 35M，但記憶體佔用仍為 11G 多

-------------------------------------------------------------------------------------------------------------
11. compared with 9.
1) use opconty_shufflenet_V2
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
10
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
==>
loss: 2.3 (last)
val_loss: 3.7305 (best)
start_time: 2019-04-26 19:22:38, end_time: 2019-04-26 20:12:45
* 本機訓練時間： 10 epoch 大約50分，而 keras MobileNetV2 大約45分，WideResNet 大約3小時45分

-------------------------------------------------------------------------------------------------------------
12. compared with 11.
1) --nb_epochs 15
2) NewSchedule
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
15
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
==>
loss: 1.92 (last)
val_loss: 3.6982 (best)
start_time: 2019-04-26 20:49:27, end_time: 2019-04-26 22:03:19
* 訓練時間：1時14分

-------------------------------------------------------------------------------------------------------------
13. compared with 11.
1) --nb_epochs 30
2) NewSchedule
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
30
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
==>
loss: 1.6853 (last)
val_loss: 3.7392 (best)
* 訓練時間：約2小時半

-------------------------------------------------------------------------------------------------------------
14. compared with 11.
1) --nb_epochs 40
2) NewSchedule
3) save final model: model.h5
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
40
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
==>
loss: 1.6853 (last)
val_loss: 3.7392 (best)
start_time: 2019-04-27 08:15:06, end_time: 2019-04-27 11:26:40
* 訓練時間：約3小時11分

-------------------------------------------------------------------------------------------------------------
15. compared with 14.
1) --nb_epochs 50
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
50
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
==>
loss: 1.35 (last)
val_loss: 3.76 (best)
start_time: 2019-04-27 11:48:56, end_time: 2019-04-27 15:37:54
* 訓練時間：約3小時49分

-------------------------------------------------------------------------------------------------------------
16. compared with 15.
1) --nb_epochs 50
2) add load_wiki()
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_wiki
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/wiki_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
50
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
==>
loss: 1.2 (last)
val_loss: 3.86 (best)
start_time: 2019-04-27 18:51:47, end_time: 2019-04-27 23:29:33
* 訓練時間：約4小時38分

-------------------------------------------------------------------------------------------------------------
17. compared with 16.
1) --validation_split 0.2
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_wiki
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/wiki_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
50
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
--validation_split 0.2
==>
loss: 1.15 (last)
val_loss: 3.84502 (best)
start_time: 2019-04-28 00:15:27, end_time: 2019-04-28 04:28:18
* 訓練時間：約4小時13分

-------------------------------------------------------------------------------------------------------------
** 18. compared with 16.
1) --validation_split 0.15
2) --nb_epochs 60
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/imdb_db.mat
--input_wiki
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/wiki_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
60
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
--validation_split 0.15
==>
start_time: 2019-04-28 08:44:52, end_time: 2019-04-28 13:56:42
loss: 0.9468 (last)
val_loss: 3.86597 (best)
* 訓練時間：約5小時12分
* 影片實測(demo.py)：最後的模型 model.h5，感覺效果最好

-------------------------------------------------------------------------------------------------------------
19. compared with 16.
1) --validation_split 0.15
2) --nb_epochs 30
3) --batch_size 48
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation
data/imdb_db.mat
--input_wiki
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/wiki_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
30
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
--validation_split
0.15
--batch_size
48
==>
start_time: 2019-04-28 15:49:04, end_time: 2019-04-28 17:39:50
loss: 1.7754 (last)
val_loss: 3.83922 (best)
* 訓練時間：約1小時50分

-------------------------------------------------------------------------------------------------------------
20. compared with 16.
1) --validation_split 0.15
2) --nb_epochs 30
3) --batch_size 64
==>
python3 train_shufflenet.py
--input_agender
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation
data/imdb_db.mat
--input_wiki
/media/vincentkao/Data/face_AGE_estimation/age-gender-estimation/data/wiki_db.mat
--input_emotion
/media/vincentkao/Data/datasets/fer2013/fer2013.csv
--nb_epochs
30
--staircase_decay_at_epochs
(5,8,)
--lr
0.1
--validation_split
0.15
--batch_size
64
==>
start_time: 2019-04-28 18:45:13, end_time: 2019-04-28 20:09:48
loss: 1.8884 (last)
val_loss: 3.83235 (best)
* 訓練時間：約1小時24分